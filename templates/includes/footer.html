<footer class="border-t border-border bg-card">
  <div class="mx-auto max-w-7xl px-6 py-16 lg:px-8 lg:py-24">
    <div class="mx-auto max-w-2xl">
      <div class="rounded-2xl border border-border bg-background p-6 sm:p-8 text-center">
        <h2 class="text-xl font-semibold tracking-tight sm:text-2xl" style="text-wrap: balance;">
          Want to know when we launch?
        </h2>
        <p class="mt-3 text-sm text-muted-foreground">
          Subscribe to the free newsletter and get the first ping when the community opens.
        </p>
        <div class="mt-6">
          <div class="subscribe-form-container" data-redirect-to="">
            <form class="subscribe-form flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-center" onsubmit="return handleFooterSubscribe(event, this)">
              <input type="email" name="email" required
                     placeholder="Enter your email"
                     class="w-full rounded-md border border-border bg-background px-4 py-2.5 text-sm text-foreground placeholder-muted-foreground focus:border-accent focus:outline-none focus:ring-1 focus:ring-accent sm:w-auto sm:flex-1 sm:max-w-xs">
              <button type="submit"
                      class="inline-flex shrink-0 items-center justify-center gap-2 rounded-md bg-accent px-5 py-2.5 text-sm font-medium text-accent-foreground transition-colors hover:bg-accent/90">
                Subscribe
              </button>
            </form>
            <p class="footer-subscribe-message mt-2 text-sm hidden"></p>
            <p class="footer-subscribe-error mt-2 text-sm text-red-400 hidden"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-16 grid gap-8 border-t border-border pt-8 sm:grid-cols-2">
      <div>
        <a href="/" class="flex items-center gap-2">
          <div class="h-6 w-6 rounded bg-accent"></div>
          <span class="font-semibold">AI Shipping Labs</span>
        </a>
        <p class="mt-4 text-sm text-muted-foreground">
          Where action-oriented builders turn AI ideas into real projects.
        </p>
      </div>

      <div>
        <h3 class="text-sm font-semibold text-foreground">Community</h3>
        <ul class="mt-4 space-y-3">
          <li>
            <a href="/about" class="text-sm text-muted-foreground transition-colors hover:text-foreground">About</a>
          </li>
          <li>
            <a href="/#tiers" class="text-sm text-muted-foreground transition-colors hover:text-foreground">Membership Tiers</a>
          </li>
          <li>
            <a href="/#faq" class="text-sm text-muted-foreground transition-colors hover:text-foreground">FAQ</a>
          </li>
          <li>
            <a href="{{ stripe_customer_portal_url }}" target="_blank" rel="noopener noreferrer" class="text-sm text-muted-foreground transition-colors hover:text-foreground">Manage Subscription</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="mt-8 border-t border-border pt-8 text-center">
      <p class="text-sm text-muted-foreground">
        &copy; {{ current_year }} AI Shipping Labs. All rights reserved.
      </p>
    </div>
  </div>

  <script>
  function handleFooterSubscribe(event, form) {
    event.preventDefault();
    var container = form.closest('.subscribe-form-container');
    var emailInput = form.querySelector('input[name="email"]');
    var submitBtn = form.querySelector('button[type="submit"]');
    var messageEl = container.querySelector('.footer-subscribe-message');
    var errorEl = container.querySelector('.footer-subscribe-error');

    messageEl.classList.add('hidden');
    errorEl.classList.add('hidden');
    submitBtn.disabled = true;
    var originalText = submitBtn.textContent;
    submitBtn.textContent = 'Subscribing...';

    var csrfToken = '';
    var cookies = document.cookie.split(';');
    for (var i = 0; i < cookies.length; i++) {
      var cookie = cookies[i].trim();
      if (cookie.startsWith('csrftoken=')) {
        csrfToken = cookie.substring('csrftoken='.length);
        break;
      }
    }

    fetch('/api/subscribe', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': csrfToken,
      },
      body: JSON.stringify({ email: emailInput.value }),
    })
    .then(function(resp) { return resp.json(); })
    .then(function(data) {
      if (data.status === 'ok') {
        messageEl.textContent = data.message;
        messageEl.className = 'footer-subscribe-message mt-2 text-sm text-green-400';
        messageEl.classList.remove('hidden');
        emailInput.value = '';
      } else {
        errorEl.textContent = data.error || 'Something went wrong.';
        errorEl.classList.remove('hidden');
      }
      submitBtn.disabled = false;
      submitBtn.textContent = originalText;
    })
    .catch(function() {
      errorEl.textContent = 'An error occurred. Please try again.';
      errorEl.classList.remove('hidden');
      submitBtn.disabled = false;
      submitBtn.textContent = originalText;
    });

    return false;
  }
  </script>
</footer>
